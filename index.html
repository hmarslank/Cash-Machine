<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Creator Hub: Get Stock Ideas (Simple Version)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F9FA; /* Very light gray */
            color: #333333; /* Dark gray for main text */
        }
        .nav-btn {
            transition: all 0.2s ease-in-out;
            border-bottom: 3px solid transparent;
            padding-bottom: 0.75rem;
            color: #666666; /* Lighter gray for inactive nav */
        }
        .nav-btn.active {
            color: #008080; /* Deep Teal for active nav */
            border-bottom-color: #008080;
        }
        .step-content { display: none; }
        .step-content.active { display: block; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.5s ease-out forwards; }

        .chart-container { position: relative; width: 100%; max-width: 500px; margin-left: auto; margin-right: auto; height: 300px; max-height: 350px; }
        @media (min-width: 768px) { .chart-container { height: 350px; } }

        .loading-spinner {
            border: 4px solid #e0e0e0; /* Light gray */
            border-top: 4px solid #008080; /* Deep Teal */
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 1rem auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .niche-card {
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s, background-color 0.2s, border-color 0.2s;
            border-width: 1px; /* Add border for cleaner look */
            border-color: #e5e7eb; /* gray-200 */
        }
        .niche-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .niche-card.selected {
            border-color: #008080;
            background-color: #E0F2F2; /* Lighter Teal */
            font-weight: 600;
            color: #004d4d; /* Darker Teal text */
        }
        .keyword-chip, .prompt-chip-item {
            cursor: pointer;
            transition: background-color 0.1s;
        }
        .keyword-chip:hover, .prompt-chip-item:hover {
            background-color: #E0F2F2; /* Lighter Teal */
        }

        /* Message Box for Copy/Paste Instruction */
        .message-box {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #008080; /* Deep Teal */
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none; /* Hidden by default */
            font-size: 0.9rem;
            animation: slideInUp 0.3s forwards, fadeOut 0.5s 4s forwards;
            white-space: nowrap; /* Prevent text wrapping */
        }

        @keyframes slideInUp {
            from { transform: translateX(-50%) translateY(50px); opacity: 0; }
            to { transform: translateX(-50%) translateY(0); opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; display: none; } /* Ensure it becomes display:none after animation */
        }

        /* Styles for copied prompt highlighting */
        .prompt-chip-item.copied {
            background-color: #d1fae5; /* Light green */
            border-color: #10b981; /* Green border */
            animation: copiedFade 2s forwards;
        }

        @keyframes copiedFade {
            0% { background-color: #d1fae5; border-color: #10b981; }
            100% { background-color: #f9fafb; border-color: #e5e7eb; } /* Revert to original background */
        }

        /* Style for used keyword in input */
        .prompt-keyword-input-used {
            border-color: #ef4444 !important; /* Red border */
            box-shadow: 0 0 0 1px #ef4444; /* Red shadow */
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white shadow-sm">
        <div class="container mx-auto px-4 py-6 text-center">
            <h1 class="text-4xl md:text-5xl font-black tracking-tighter text-gray-900">Create & Cash</h1>
            <p class="text-lg md:text-xl font-semibold text-teal-600">The AI Stock Blueprint</p>
        </div>
    </header>

    <nav id="main-nav" class="sticky top-0 bg-white/90 backdrop-blur-sm z-50 shadow-md">
        <div class="container mx-auto px-4">
            <div class="flex justify-center items-center font-bold text-gray-500 overflow-x-auto text-sm md:text-base">
                <button data-step="0" class="nav-btn active py-3 px-2 md:px-4">Intro</button>
                <button data-step="1" class="nav-btn py-3 px-2 md:px-4">1. Toolkit</button>
                <button data-step="2" class="nav-btn py-3 px-2 md:px-4">2. Organic</button>
                <button data-step="3" class="nav-btn py-3 px-2 md:px-4">3. Discovery</button>
                <button data-step="4" class="nav-btn py-3 px-2 md:px-4">4. AI Tools</button>
                <button data-step="5" class="nav-btn py-3 px-2 md:px-4">5. AI Prompts</button>
                <button data-step="6" class="nav-btn py-3 px-2 md:px-4">6. Generate Images</button>
                <button data-step="7" class="nav-btn py-3 px-2 md:px-4">7. Smart Tagging</button>
                <button data-step="8" class="nav-btn py-3 px-2 md:px-4">8. Scale & Grow</button>
                <button data-step="9" class="nav-btn py-3 px-2 md:px-4">Start Now</button>
            </div>
        </div>
    </nav>

    <main class="container mx-auto p-4 md:p-8">
        <section id="step-content-0" class="step-content active fade-in">
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg text-center">
                <h2 class="text-2xl md:text-3xl font-bold mb-4">Stop Scrolling, Start Earning.</h2>
                <p class="max-w-3xl mx-auto text-gray-700 mb-8">Your direct guide to earning with visuals on Adobe Stock. No fluff, no low-pay gigs. Just actionable steps to monetize your creativity, heavily leveraging AI for rapid content creation.</p>
                <div class="grid md:grid-cols-3 gap-6 text-left">
                    <div class="bg-gray-50 p-6 rounded-lg border-l-4 border-teal-600">
                        <h3 class="font-bold text-lg mb-2">Passive Income Engine</h3>
                        <p class="text-sm text-gray-600">Create once, earn 24/7. Your visuals become assets that work for you.</p>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-lg border-l-4 border-teal-600">
                        <h3 class="font-bold text-lg mb-2">AI-Powered Creation</h3>
                        <p class="text-sm text-gray-600">Generate stunning images efficiently, saving time and scaling your output effortlessly.</p>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-lg border-l-4 border-teal-600">
                        <h3 class="font-bold text-lg mb-2">Global Marketplace</h3>
                        <p class="text-sm text-gray-600">Access millions of buyers worldwide directly through Adobe apps. Unmatched visibility.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="step-content-1" class="step-content fade-in">
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">1. Essential Toolkit & Setup</h2>
                <p class="max-w-3xl mx-auto text-gray-700 mb-8">Gather your basic gear and set up your Adobe Stock account. You likely have most of what you need already!</p>
                <div class="grid md:grid-cols-2 gap-8 items-start">
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-bold text-xl mb-4 text-teal-600">Your Gear</h3>
                        <ul class="space-y-3 text-base">
                            <li class="flex items-start"><span class="text-teal-600 font-bold mr-2">✓</span><div><b>Device:</b> Laptop, phone, or camera.</div></li>
                            <li class="flex items-start"><span class="text-teal-600 font-bold mr-2">✓</span><div><b>Internet:</b> Reliable connection for uploads.</div></li>
                            <li class="flex items-start"><span class="text-teal-600 font-bold mr-2">✓</span><div><b>Keen Eye:</b> Intuition for marketable visuals.</div></li>
                            <li class="flex items-start"><span class="text-teal-600 font-bold mr-2">✓</span><div><b>Dedication:</b> 2 hours daily, consistently.</div></li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-lg">
                        <h3 class="font-bold text-xl mb-4 text-teal-600">Quick Setup</h3>
                           <ol class="list-decimal list-inside space-y-3 text-base">
                                <li><b>Sign Up:</b> Visit <a href="https://contributor.stock.adobe.com/en?isa0=1" target="_blank" class="font-semibold text-teal-600 hover:underline">Adobe Stock Contributor</a>.</li>
                                <li><b>Verify:</b> Complete ID & tax info for payouts.</li>
                                <li><b>Go Live:</b> Account active! Adobe handles sales.</li>
                            </ol>
                            <p class="text-sm text-amber-700 mt-4">Pro Tip: Double-check country of residence during sign-up.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="step-content-2" class="step-content fade-in">
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">2. Organic Content Creation</h2>
                <p class="max-w-3xl mx-auto text-gray-700 mb-8 text-center">Unique photos & videos offer authenticity. Focus on quality, composition, and trending subjects.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="bg-gray-50 p-5 rounded-lg border">
                        <h3 class="font-bold text-lg mb-2 text-teal-600">Key Niches</h3>
                        <p class="text-sm text-gray-700 mb-3">Focus on themes with consistent buyer demand:</p>
                        <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                            <li>**Authentic Lifestyle:** Real, unposed human moments, diverse groups, remote work, mental wellness.</li>
                            <li>**Modern Tech Use:** People interacting with devices, clean interfaces, innovative tech concepts.</li>
                            <li>**Diversity & Inclusion:** Genuinely representing various ages, ethnicities, body types, and abilities.</li>
                            <li>**Conceptual Imagery:** Visually representing abstract ideas like "growth," "connection," "innovation."</li>
                            <li>**Vertical Video:** Short, engaging, and well-lit clips optimized for social media stories and reels.</li>
                            <li>**Sustainable Living:** Eco-conscious practices, recycling, urban gardening, renewable energy.</li>
                            <li>**Remote Work Productivity:** Beyond desk setups – work from cafes, parks, travel.</li>
                            <li>**Authentic Mental Wellness:** Self-care, mindfulness, digital detox.</li>
                            <li>**Generational Collaboration:** Multiple generations interacting naturally in various settings.</li>
                            <li>**Digital Nomads/Van Life:** Freedom, minimalist lifestyle, connectivity on the go.</li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 p-5 rounded-lg border">
                        <h3 class="font-bold text-lg mb-2 text-teal-600">Quality First</h3>
                        <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                            <li>**Sharpness & Focus:** No blur.</li>
                            <li>**Lighting:** Natural light often best.</li>
                            <li>**Composition:** Frame well, leave "copy space."</li>
                            <li>**Cleanliness:** No logos/trademarks.</li>
                            <li>**Technical Specs:** Meet 4MP minimum.</li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 p-5 rounded-lg border">
                        <h3 class="font-bold text-lg mb-2 text-teal-600">Legal Musts</h3>
                        <ul class="list-disc list-inside text-sm text-gray-700 space-y-1">
                            <li>**Model Releases:** MANDATORY for recognizable people.</li>
                            <li>**Property Releases:** REQUIRED for private property.</li>
                            <li><p class="text-xs text-amber-700 mt-2">Missing releases = rejection.</p></li>
                        </ul>
                    </div>
                </div>
                <p class="mt-8 p-4 bg-emerald-50 rounded-lg border border-emerald-200 font-bold text-emerald-800 text-sm">Action: Practice! Shoot 5-10 high-quality concepts today. Focus on composition & lighting.</p>
            </div>
        </section>

        <section id="step-content-3" class="step-content fade-in">
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">3. Niche & Keyword Discovery</h2>
                <p class="max-w-3xl mx-auto text-gray-700 mb-8 text-center">Pinpoint high-demand niches and grab relevant keywords. Explore categories, then dive into specific content opportunities.</p>
                
                <div id="niche-generation-section" class="bg-gray-50 p-6 rounded-lg border mb-8">
                    <h3 class="font-bold text-xl mb-4 text-center text-teal-600">Stage 1: Discover Unique Niches</h3>
                    <p class="text-sm text-center text-gray-700 mb-4">Select a category. Our AI generates 15-20 specific, low-competition niches. **Click any niche card to automatically grab 100 keywords for it below!**</p>
                    <div class="max-w-md mx-auto">
                        <select id="niche-category-select" class="w-full p-2 border border-gray-300 rounded-md mb-4 focus:ring-teal-600 focus:border-teal-600">
                            <option value="">-- Select a Niche Category --</option>
                            <option value="Emerging Technologies">Emerging Technologies</option>
                            <option value="Subculture & Niche Lifestyles">Subculture & Niche Lifestyles</option>
                            <option value="Future of Work & Education">Future of Work & Education</option>
                            <option value="Abstract & Conceptual Visuals">Abstract & Conceptual Visuals</option>
                            <option value="Sustainable & Eco-Conscious Living">Sustainable & Eco-Conscious Living</option>
                            <option value="Authentic Diversity & Inclusivity">Authentic Diversity & Inclusivity</option>
                            <option value="Micro-moments & Everyday Life">Micro-moments & Everyday Life</option>
                            <option value="Global Cultural Celebrations (Untraditional)">Global Cultural Celebrations (Untraditional)</option>
                            <option value="Health & Wellness Beyond Fitness">Health & Wellness Beyond Fitness</option>
                            <option value="AI & Robotics in Daily Life">AI & Robotics in Daily Life</option>
                            <option value="Urban Exploration & Architecture Details">Urban Exploration & Architecture Details</option>
                            <option value="Mindful Living & Digital Detox">Mindful Living & Digital Detox</option>
                            <option value="Sensory Experiences (Texture, Sound Vis.)">Sensory Experiences (Texture, Sound Vis.)</option>
                            <option value="Retro Futurism & Nostalgia">Retro Futurism & Nostalgia</option>
                            <option value="Financial Literacy & Investing (Visualized)">Financial Literacy & Investing (Visualized)</option>
                            <option value="Community Building & Local Events">Community Building & Local Events</option>
                            <option value="Home Automation & Smart Living">Home Automation & Smart Living</option>
                            <option value="Artisanal Crafts & Handmade Goods">Artisanal Crafts & Handmade Goods</option>
                            <option value="Space Exploration & Astronomy (Conceptual)">Space Exploration & Astronomy (Conceptual)</option>
                            <option value="Generational Dynamics (Specific Interactions)">Generational Dynamics (Specific Interactions)</option>
                        </select>
                        <button id="generate-niches-btn" class="w-full bg-teal-600 text-white font-bold px-6 py-2 rounded-lg hover:bg-teal-700 transition">Generate Niches</button>
                        <button id="clear-niche-generator-history-btn" class="w-full bg-red-500 text-white font-bold px-6 py-2 rounded-lg hover:bg-red-600 transition mt-2 text-sm">Clear Niche History</button>
                    </div>
                    
                    <div id="niche-generator-loading" class="hidden loading-spinner"></div>
                    <div id="niche-generator-error" class="hidden mt-4 text-center text-red-600 font-semibold"></div>
                    <div id="niche-generator-output" class="mt-6 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2 text-sm max-h-96 overflow-y-auto p-2 border border-gray-200 rounded-md bg-white">
                        </div>
                    <p class="text-xs text-gray-500 mt-4 text-center">**Note:** New niches are unique per category session. Click a niche to get its keywords!</p>
                </div>

                <div id="keyword-generation-section" class="bg-gray-50 p-6 rounded-lg border hidden">
                    <h3 class="font-bold text-xl mb-4 text-center text-teal-600">Stage 2: Keywords for <b id="selected-niche-display" class="text-teal-700"></b></h3>
                    <p class="text-sm text-center text-gray-700 mb-4">Here are 100 high-demand keywords generated for your selected niche. **Click any keyword to automatically populate it in the 'AI Prompts' section (Step 5)!**</p>
                    
                    <button id="clear-subniche-keywords-btn" class="w-full bg-red-500 text-white font-bold px-6 py-2 rounded-lg hover:bg-red-600 transition mt-2 text-sm max-w-md mx-auto block">Clear Keywords History</button>
                    
                    <div id="keyword-grabber-loading" class="hidden loading-spinner"></div>
                    <div id="keyword-grabber-error" class="hidden mt-4 text-center text-red-600 font-semibold"></div>
                    <div id="keyword-grabber-output" class="mt-6 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2 text-sm max-h-96 overflow-y-auto p-2 border border-gray-200 rounded-md bg-white">
                        </div>
                    <p class="text-xs text-gray-500 mt-4 text-center">**Pro Tip:** Click any keyword to jump to Step 5 and start generating AI prompts!</p>
                </div>
            </div>
        </section>

        <section id="step-content-4" class="step-content fade-in">
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">4. AI Tools Unleashed</h2>
                <p class="max-w-3xl mx-auto text-gray-700 mb-8 text-center">AI tools empower you to create stunning, unique stock images at scale. Focus on efficiency and leveraging AI for maximum output.</p>
                <div class="grid md:grid-cols-2 gap-6 items-center">
                    <div class="bg-gray-50 p-6 rounded-lg border">
                        <h3 class="font-bold text-xl mb-4 text-teal-600">Why AI for Stock?</h3>
                        <ul class="list-disc list-inside text-base text-gray-700 space-y-2">
                            <li>**Speed:** Dozens of images in minutes.</li>
                            <li>**Scale:** High volume, no models/locations.</li>
                            <li>**Versatility:** Create abstract or specific scenarios easily.</li>
                            <li>**Cost-Effective:** Drastically reduces production costs.</li>
                        </ul>
                    </div>
                    <div class="bg-gray-50 p-6 rounded-lg border">
                        <h3 class="font-bold text-xl mb-4 text-teal-600">Your AI Arsenal</h3>
                        <p class="text-sm text-gray-700 mb-3">Leading platforms for AI image generation:</p>
                        <ul class="list-disc list-inside text-base text-gray-700 space-y-2">
                            <li>**Leonardo AI:** User-friendly, photorealistic & stylized (free tiers).</li>
                            <li>**Midjourney:** Artistic, high-quality outputs (Discord-based).</li>
                            <li>**DALL-E (OpenAI):** Powerful and versatile.</li>
                        </ul>
                        <p class="text-sm text-amber-700 mt-4">Guide focuses on **Leonardo AI** examples.</p>
                    </div>
                </div>
                <p class="mt-8 p-4 bg-emerald-50 rounded-lg border border-emerald-200 font-bold text-emerald-800 text-sm">Key: Image quality depends on your "prompt." Learn to craft perfect prompts here!</p>
            </div>
        </section>

        <section id="step-content-5" class="step-content fade-in">
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">5. AI Prompt Masterclass</h2>
                <p class="max-w-3xl mx-auto text-gray-700 mb-8 text-center">Turn a simple keyword into a powerful AI command. A well-crafted prompt ensures you get exact image quality for Adobe Stock. Generate 10 unique prompts from a single keyword.</p>
                
                <div class="bg-gray-50 p-6 rounded-lg border">
                    <h3 class="font-bold text-lg mb-4 text-center">Keyword to 10 Prompts:</h3>
                    <p class="text-sm text-center text-gray-700 mb-4">Enter a keyword (e.g., "startup team", "forest stream"). AI generates 10 unique prompts. **Click any generated prompt to copy & open Leonardo AI!**</p>
                    <div class="flex flex-col sm:flex-row gap-2 max-w-xl mx-auto">
                        <input type="text" id="prompt-keyword-input" placeholder="Enter keyword (e.g., 'German dog')" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-teal-600 focus:border-teal-600">
                        <button id="generate-prompts-btn" class="w-full sm:w-auto bg-teal-600 text-white font-bold px-6 py-2 rounded-lg hover:bg-teal-700 transition">Generate 10 Prompts</button>
                    </div>
                    <p id="prompt-keyword-history-note" class="text-xs text-orange-600 mt-2 hidden text-center">Note: This keyword has been used before.</p>
                    <button id="clear-prompt-keywords-btn" class="w-full bg-red-500 text-white font-bold px-6 py-2 rounded-lg hover:bg-red-600 transition mt-2 text-sm max-w-xl mx-auto block">Clear Prompt History</button>
                    
                    <div id="prompts-loading" class="hidden loading-spinner"></div>
                    <div id="prompts-error" class="hidden mt-4 text-center text-red-600 font-semibold"></div>
                    <div id="prompts-output" class="mt-6 space-y-4 text-base bg-white p-4 rounded-md border max-h-96 overflow-y-auto">
                        </div>
                    <div id="prompt-copy-message" class="message-box">Prompt copied! Switch to the new tab and paste.</div>
                </div>
                <p class="mt-8 p-4 bg-emerald-50 rounded-lg border border-emerald-200 font-bold text-emerald-800 text-sm">Pro Tip: Good prompts include: **Subject + Action + Setting + Style + Technical Details** (e.g., 8K, white background). Aim for clarity and detail!</p>
            </div>
        </section>

        <section id="step-content-6" class="step-content fade-in">
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">6. Prompts to AI Images</h2>
                <p class="max-w-3xl mx-auto text-gray-700 mb-8 text-center">Now, turn your perfect prompts into high-quality stock images with Leonardo AI. It's powerful and straightforward!</p>
                
                <div class="bg-gray-50 p-6 rounded-lg border mb-6">
                    <h3 class="font-bold text-xl mb-4 text-teal-600">Leonardo AI Walkthrough:</h3>
                    <ol class="list-decimal list-inside space-y-4 text-base">
                        <li><b>Access:</b> Go to <a href="https://leonardo.ai" target="_blank" class="font-semibold text-teal-600 hover:underline">leonardo.ai</a>, log in, go to "AI Image Generation."</li>
                        <li><b>Choose Model:</b> Select an AI model (e.g., "Leonardo Diffusion").</li>
                        <li><b>Input Prompt:</b> Paste a prompt from Step 5.</li>
                        <li><b>Negative Prompts:</b> Crucial for stock! Add terms like: <code class="bg-gray-200 p-1 rounded-sm text-xs">ugly, deformed, blurry, watermark, text</code>.</li>
                        <li><b>Adjust Settings:</b>
                            <ul class="list-disc list-inside ml-4 mt-2 text-sm text-gray-700">
                                <li><b>Aspect Ratio:</b> Aim for 3:2, 4:3, or 16:9.</li>
                                <li><b>Image Count:</b> 4-8 per prompt.</li>
                                <li><b>Tiling:</b> Keep OFF.</li>
                            </ul>
                        </li>
                        <li><b>Generate!</b> Click.</li>
                        <li><b>Review & Refine:</b> Examine the generated images. Download the best ones. If they're not quite right, tweak your prompt or negative prompt and re-generate.</li>
                    </ol>
                </div>
                <p class="mt-8 p-4 bg-emerald-50 rounded-lg border border-emerald-200 font-bold text-emerald-800 text-sm">Quality matters. Look for crispness, correct anatomy, natural lighting, and commercial appeal. Only upload your absolute best.</p>
            </div>
        </section>

        <section id="step-content-7" class="step-content fade-in">
            <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">7. Smart Tagging & Export</h2>
                <p class="max-w-3xl mx-auto text-gray-700 mb-8 text-center">Boost efficiency with AI-powered metadata. Upload images in batch, let Gemini analyze, and export titles & tags ready for Adobe Stock.</p>
                
                <div class="bg-gray-50 p-6 rounded-lg border mb-6">
                    <h3 class="font-bold text-xl mb-4 text-center">Batch Image Metadata Generator</h3>
                    <p class="text-sm text-center text-gray-700 mb-4">Upload your images (up to 200). Our AI will analyze them and suggest titles & tags.</p>
                    
                    <input type="file" id="image-upload-input" accept="image/jpeg, image/png" multiple class="w-full text-sm text-gray-600 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-teal-50 file:text-teal-700 hover:file:bg-teal-100 mb-4">
                    <p id="upload-status" class="text-center text-gray-500 text-sm mb-4"></p>

                    <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-6 p-4 bg-white rounded-md border">
                        <div class="flex items-center space-x-2 w-full sm:w-auto">
                            <label for="title-length-slider" class="text-sm font-medium text-gray-700 whitespace-nowrap">Title Length:</label>
                            <input type="range" id="title-length-slider" min="60" max="180" value="100" class="w-full accent-teal-600">
                            <span id="title-length-value" class="text-sm font-bold text-teal-700 w-12 text-right">100</span>
                        </div>
                        <div class="flex items-center space-x-2 w-full sm:w-auto">
                            <label for="tags-limit-slider" class="text-sm font-medium text-gray-700 whitespace-nowrap">Tags Count:</label>
                            <input type="range" id="tags-limit-slider" min="0" max="49" value="30" class="w-full accent-teal-600">
                            <span id="tags-limit-value" class="text-sm font-bold text-teal-700 w-12 text-right">30</span>
                        </div>
                        <div class="flex items-center w-full sm:w-auto">
                            <input type="checkbox" id="transparent-background-toggle" class="form-checkbox h-4 w-4 text-teal-600 transition duration-150 ease-in-out rounded focus:ring-teal-500">
                            <label for="transparent-background-toggle" class="ml-2 block text-sm text-gray-700 whitespace-nowrap">Add "transparent background"</label>
                        </div>
                    </div>
                    
                    <button id="analyze-images-btn" class="w-full bg-teal-600 text-white font-bold px-6 py-3 rounded-lg hover:bg-teal-700 transition disabled:opacity-50 disabled:cursor-not-allowed">Analyze & Generate Metadata</button>
                    
                    <div id="metadata-loading" class="hidden loading-spinner"></div>
                    <div id="metadata-error" class="hidden mt-4 text-center text-red-600 font-semibold"></div>
                    
                    <div id="image-previews-container" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 mt-6 max-h-64 overflow-y-auto p-2 border border-gray-200 rounded-md bg-white hidden">
                        </div>

                    <div id="metadata-results-container" class="mt-6 hidden">
                        <h4 class="font-bold text-lg mb-3 text-center text-teal-600">Generated Metadata (Ready for CSV)</h4>
                        <div class="bg-white p-4 rounded-md border max-h-96 overflow-y-auto">
                            <table class="min-w-full text-sm divide-y divide-gray-200">
                                <thead class="bg-gray-50 sticky top-0">
                                    <tr>
                                        <th class="px-2 py-2 text-left text-gray-600 font-semibold">Image</th>
                                        <th class="px-2 py-2 text-left text-gray-600 font-semibold">Title</th>
                                        <th class="px-2 py-2 text-left text-gray-600 font-semibold">Keywords</th>
                                    </tr>
                                </thead>
                                <tbody id="metadata-table-body" class="divide-y divide-gray-200">
                                    </tbody>
                            </table>
                        </div>
                        <button id="export-csv-btn" class="w-full bg-green-600 text-white font-bold px-6 py-3 rounded-lg hover:bg-green-700 transition mt-6 disabled:opacity-50 disabled:cursor-not-allowed">Export to CSV</button>
                    </div>
                </div>
            </div>
        </section>

            <section id="step-content-8" class="step-content fade-in">
                <div class="bg-white p-6 md:p-8 rounded-xl shadow-lg">
                    <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">8. Analyze, Adapt & Scale</h2>
                    <p class="max-w-3xl mx-auto text-gray-700 mb-8 text-center">Monitor performance, learn from data, and strategically scale your portfolio for long-term income growth. Optimize your profit machine!</p>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div class="bg-gray-50 p-6 rounded-lg border">
                            <h3 class="font-bold text-lg mb-2 text-center text-teal-600">Illustrative Earnings</h3>
                            <p class="text-sm text-gray-600 mb-4 text-center">Consistent uploads lead to exponential growth. This chart shows a typical trajectory.</p>
                            <div class="chart-container">
                                <canvas id="growthChart"></canvas>
                            </div>
                        </div>
                        <div class="bg-gray-50 p-6 rounded-lg border">
                            <h3 class="font-bold text-lg mb-2 text-center text-teal-600">Portfolio Mix</h3>
                            <p class="text-sm text-gray-600 mb-4 text-center">Diversify content types to tap more buyer segments and maximize earnings.</p>
                            <div class="chart-container">
                                <canvas id="mixChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div class="mt-8 grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-gray-50 p-6 rounded-lg border">
                            <h3 class="font-bold text-lg mb-2 text-teal-600">Analyze & Adapt: Your Dashboard is Gold</h3>
                            <ul class="list-disc list-inside text-base text-gray-700 space-y-2">
                                <li><b>Monitor Sales:</b> Regularly check your Adobe Stock Contributor dashboard. See what sells best.</li>
                                <li><b>Create More:</b> Double down on best-performing content categories.</li>
                                <li><b>Learn:</b> Use rejection feedback to improve.</li>
                            </ul>
                        </div>
                        <div class="bg-gray-50 p-6 rounded-lg border">
                            <h3 class="font-bold text-lg mb-2 text-teal-600">Reinvest & Stay Current: Future-Proof Income</h3>
                            <ul class="list-disc list-inside text-base text-gray-700 space-y-2">
                                <li><b>Smart Reinvestment:</b> Use earnings to upgrade AI subscriptions, software, or advanced courses.</li>
                                <li><b>Stay Savvy:</b> Follow market trends & new tech.</li>
                                <li><b>Consistency:</b> Regular uploads build long-term income.</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>

            <section id="step-content-9" class="step-content fade-in">
                <div class="bg-teal-600 text-white p-8 md:p-12 rounded-xl shadow-lg text-center">
                    <h2 class="text-3xl md:text-4xl font-black mb-4">Your Money Move. Today.</h2>
                    <p class="text-lg text-teal-100 max-w-2xl mx-auto mb-8">You have the blueprint to monetize stunning visuals on Adobe Stock, with AI power. Stop waiting! Build your flexible income stream now.</p>
                    <a href="https://contributor.stock.adobe.com/en?isa0=1" target="_blank" class="inline-block bg-white text-teal-600 font-bold text-lg px-10 py-4 rounded-lg hover:bg-gray-100 transition-transform transform hover:scale-105 shadow-lg">
                        Start Your Adobe Stock Journey Now!
                    </a>
                </div>
            </section>
        </main>
    </div> <div id="prompt-copy-message" class="message-box">Prompt copied! Now switch to the new tab and paste it into the prompt input field.</div>

    <script>
        // --- IMPORTANT: Configure your Gemini API Key directly here ---
        // This key will be visible in your app's code. Use with caution for public apps.
        // Get your key from: https://aistudio.google.com/app/apikey
        const GEMINI_API_KEY = "AIzaSyB5nnpO3T2yh4id5ErSKNW5dee6FlzgraQ"; // <<< REPLACE THIS WITH YOUR ACTUAL KEY!

        // Firebase SDKs are removed for this simplified version.
        // Firebase configuration, authentication, and Firestore logic are also removed.

        document.addEventListener('DOMContentLoaded', () => {
            const navButtons = document.querySelectorAll('.nav-btn');
            const stepContents = document.querySelectorAll('.step-content');
            
            // --- History Management Functions (remain the same) ---
            const getHistory = (key) => {
                try {
                    return JSON.parse(localStorage.getItem(key)) || [];
                } catch (e) {
                    console.error('Error parsing localStorage for key', key, e);
                    return [];
                }
            };

            const saveHistory = (key, history) => {
                localStorage.setItem(key, JSON.stringify(history));
            };

            const addKeywordToHistory = (key, keyword) => {
                let history = getHistory(key);
                const lowerKeyword = keyword.toLowerCase(); // Store in lowercase for case-insensitive check
                if (!history.includes(lowerKeyword)) {
                    history.push(lowerKeyword);
                    saveHistory(key, history);
                }
            };

            const isKeywordInHistory = (key, keyword) => {
                const history = getHistory(key);
                return history.includes(keyword.toLowerCase()); // Check in lowercase
            };

            const clearHistory = (key) => {
                localStorage.removeItem(key);
            };
            // --- End History Management Functions ---


            // Main navigation
            const navigateToStep = (stepIndex) => {
                navButtons.forEach(btn => btn.classList.remove('active'));
                navButtons[stepIndex].classList.add('active');
                stepContents.forEach((content, index) => {
                    content.classList.remove('active', 'fade-in');
                    if (index === stepIndex) { 
                        content.classList.add('active');
                        setTimeout(() => content.classList.add('fade-in'), 10);
                        content.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                });
            };

            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetStep = parseInt(button.getAttribute('data-step'));
                    navigateToStep(targetStep);
                });
            });

            // Step 3: Niche & Keyword Discovery - Stage 1 (Niche Generation)
            const nicheCategorySelect = document.getElementById('niche-category-select');
            const generateNichesBtn = document.getElementById('generate-niches-btn');
            const nicheGeneratorOutput = document.getElementById('niche-generator-output');
            const nicheGeneratorLoading = document.getElementById('niche-generator-loading');
            const nicheGeneratorError = document.getElementById('niche-generator-error');
            const clearNicheGeneratorHistoryBtn = document.getElementById('clear-niche-generator-history-btn');
            
            const keywordGenerationSection = document.getElementById('keyword-generation-section');
            const selectedNicheDisplay = document.getElementById('selected-niche-display');

            clearNicheGeneratorHistoryBtn.addEventListener('click', () => {
                clearHistory('generatedNicheCategories');
                nicheGeneratorOutput.innerHTML = '<p class="text-gray-500">Generated niche category history cleared. New ideas will appear next time.</p>';
                keywordGenerationSection.classList.add('hidden'); // Hide keyword section if niches are cleared
                clearHistory('usedSubNicheKeywords'); // Also clear sub-niche keywords
                document.getElementById('keyword-grabber-output').innerHTML = ''; // Clear keyword display
            });

            generateNichesBtn.addEventListener('click', async () => {
                const selectedCategory = nicheCategorySelect.value;
                if (!selectedCategory) {
                    nicheGeneratorError.textContent = 'Please select a niche category.';
                    nicheGeneratorError.classList.remove('hidden');
                    return;
                }

                nicheGeneratorOutput.innerHTML = '';
                nicheGeneratorError.classList.add('hidden');
                nicheGeneratorLoading.classList.remove('hidden');
                generateNichesBtn.disabled = true;

                const hasBeenExplored = isKeywordInHistory('generatedNicheCategories', selectedCategory);
                if (hasBeenExplored) {
                    nicheGeneratorOutput.innerHTML += `<p class="text-orange-600 font-semibold mb-2">Note: You've explored '${selectedCategory}' before. Try clearing history or selecting another category for fresh ideas!</p>`;
                }

                try {
                    const prompt = `Generate 15 highly selective, high-demand, and relatively low-competition stock photo/video sub-niches within the '${selectedCategory}' category. For each niche, provide only the niche name (without numbering or description). Present as a comma-separated list.`;
                    const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`;
                    
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(`API error: ${errorData.error || response.statusText}`);
                    }

                    const result = await response.json();
                    if (result.candidates && result.candidates[0]?.content?.parts[0]?.text) {
                        const text = result.candidates[0].content.parts[0].text;
                        const niches = text.split(',').map(n => n.trim()).filter(Boolean);
                        
                        nicheGeneratorOutput.innerHTML += niches.map(nicheText => {
                            return `<div class="niche-card bg-white p-3 rounded-md shadow-sm text-base text-center" data-niche-name="${nicheText}">${nicheText}</div>`;
                        }).join('');
                        addKeywordToHistory('generatedNicheCategories', selectedCategory);

                        document.querySelectorAll('#niche-generator-output .niche-card').forEach(card => {
                            card.addEventListener('click', async (event) => {
                                document.querySelectorAll('#niche-generator-output .niche-card').forEach(c => c.classList.remove('selected'));
                                event.currentTarget.classList.add('selected');
                                const nicheName = event.currentTarget.getAttribute('data-niche-name');
                                selectedNicheDisplay.textContent = nicheName;
                                keywordGenerationSection.classList.remove('hidden'); // Show Stage 2
                                localStorage.setItem('currentSelectedSubNiche', nicheName); // Store selected niche

                                keywordGrabberOutput.innerHTML = '';
                                keywordGrabberError.classList.add('hidden');
                                keywordGrabberLoading.classList.remove('hidden');
                                
                                try {
                                    const keywordPrompt = `Generate 100 diverse, commercially viable, and specific keywords for stock content related to the niche: '${nicheName}'. Focus on terms buyers would search for on Adobe Stock. Provide only the keywords, separated by commas, with no additional text, numbering, or explanations.`;
                                    const keywordPayload = { contents: [{ role: "user", parts: [{ text: keywordPrompt }] }] };
                                    const keywordApiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`;
                                    
                                    const keywordResponse = await fetch(keywordApiUrl, {
                                        method: 'POST',
                                        headers: { 'Content-Type': 'application/json' },
                                        body: JSON.stringify(keywordPayload)
                                    });
                                    
                                    if (!keywordResponse.ok) {
                                        const kwErrorData = await keywordResponse.json();
                                        throw new Error(`API error: ${kwErrorData.error || keywordResponse.statusText}`);
                                    }

                                    const kwResult = await keywordResponse.json();
                                    if (kwResult.candidates && kwResult.candidates[0]?.content?.parts[0]?.text) {
                                        const text = kwResult.candidates[0].content.parts[0].text;
                                        let keywords = text.split(',').map(k => k.trim()).filter(Boolean);
                                        
                                        const usedKeywordsForNiche = getHistory('usedSubNicheKeywords').filter(kw => kw.startsWith(nicheName.toLowerCase() + '::'));
                                        const uniqueKeywords = keywords.filter(k => !usedKeywordsForNiche.includes(nicheName.toLowerCase() + '::' + k.toLowerCase()));

                                        if (uniqueKeywords.length === 0 && keywords.length > 0) {
                                            keywordGrabberOutput.innerHTML = '<p class="text-gray-500">All generated keywords for this niche have been previously used. Try clearing history for this niche or selecting another.</p>';
                                        } else if (uniqueKeywords.length === 0 && keywords.length === 0) {
                                             keywordGrabberOutput.innerHTML = '<p class="text-gray-500">No keywords could be generated for this niche.</p>';
                                        } else {
                                            keywordGrabberOutput.innerHTML = uniqueKeywords.map(s => `<div class="keyword-chip bg-white p-2 rounded-md border text-center shadow-sm">${s}</div>`).join('');
                                            uniqueKeywords.forEach(k => addKeywordToHistory('usedSubNicheKeywords', nicheName + '::' + k));

                                            document.querySelectorAll('#keyword-grabber-output .keyword-chip').forEach(chip => {
                                                chip.addEventListener('click', (k_event) => {
                                                    const selectedKeyword = k_event.currentTarget.textContent;
                                                    promptKeywordInput.value = selectedKeyword;
                                                    navigateToStep(5);
                                                });
                                            });
                                        }
                                    } else {
                                        throw new Error('No keywords received.');
                                    }
                                } catch (kw_error) {
                                    console.error('Error generating keywords:', kw_error);
                                    keywordGrabberError.textContent = `Failed to get keywords: ${kw_error.message}.`;
                                    keywordGrabberError.classList.remove('hidden');
                                } finally {
                                    keywordGrabberLoading.classList.add('hidden');
                                }
                            });
                        });
                    } else {
                        throw new Error('No niches received.');
                    }
                } catch (error) {
                    console.error('Error generating niches:', error);
                    nicheGeneratorError.textContent = `Failed to get niches: ${error.message}.`;
                    nicheGeneratorError.classList.remove('hidden');
                } finally {
                    nicheGeneratorLoading.classList.add('hidden');
                    generateNichesBtn.disabled = false;
                }
            });


            // Step 3: Niche & Keyword Discovery - Stage 2 (Keyword Generation)
            const keywordGrabberOutput = document.getElementById('keyword-grabber-output');
            const keywordGrabberLoading = document.getElementById('keyword-grabber-loading');
            const keywordGrabberError = document.getElementById('keyword-grabber-error');
            const clearSubNicheKeywordsBtn = document.getElementById('clear-subniche-keywords-btn');
            
            clearSubNicheKeywordsBtn.addEventListener('click', () => {
                const currentNiche = localStorage.getItem('currentSelectedSubNiche');
                if (currentNiche) {
                    let allUsedKeywords = getHistory('usedSubNicheKeywords');
                    allUsedKeywords = allUsedKeywords.filter(kw => !kw.startsWith(currentNiche.toLowerCase() + '::'));
                    saveHistory('usedSubNicheKeywords', allUsedKeywords);
                    keywordGrabberOutput.innerHTML = `<p class="text-gray-500">Keywords history for '${currentNiche}' cleared.</p>`;
                } else {
                     keywordGrabberOutput.innerHTML = '<p class="text-gray-500">No niche selected to clear history for.</p>';
                }
            });

            // AI Prompt Crafting Masterclass (Step 5)
            const promptKeywordInput = document.getElementById('prompt-keyword-input');
            const generatePromptsBtn = document.getElementById('generate-prompts-btn');
            const promptsOutput = document.getElementById('prompts-output');
            const promptsLoading = document.getElementById('prompts-loading');
            const promptsError = document.getElementById('prompts-error');
            const promptKeywordHistoryNote = document.getElementById('prompt-keyword-history-note');
            const clearPromptKeywordsBtn = document.getElementById('clear-prompt-keywords-btn');
            const promptCopyMessage = document.getElementById('prompt-copy-message');

            promptKeywordInput.addEventListener('input', () => {
                const keyword = promptKeywordInput.value.trim();
                if (isKeywordInHistory('usedPromptKeywords', keyword)) {
                    promptKeywordInput.classList.add('prompt-keyword-input-used');
                    promptKeywordHistoryNote.classList.remove('hidden');
                } else {
                    promptKeywordInput.classList.remove('prompt-keyword-input-used');
                    promptKeywordHistoryNote.classList.add('hidden');
                }
            });

            clearPromptKeywordsBtn.addEventListener('click', () => {
                clearHistory('usedPromptKeywords');
                promptKeywordHistoryNote.classList.add('hidden');
                promptKeywordInput.classList.remove('prompt-keyword-input-used');
                promptsOutput.innerHTML = '<p class="text-gray-500">Prompt keyword history cleared.</p>';
            });

            generatePromptsBtn.addEventListener('click', async () => {
                const keyword = promptKeywordInput.value.trim();
                if (!keyword) {
                    promptsError.textContent = 'Please enter a keyword.';
                    promptsError.classList.remove('hidden');
                    return;
                }

                promptsOutput.innerHTML = '';
                promptsError.classList.add('hidden');
                promptsLoading.classList.remove('hidden');
                generatePromptsBtn.disabled = true;
                promptKeywordHistoryNote.classList.add('hidden'); // Hide note while generating

                try {
                    const prompt = `Generate 10 highly detailed, unique, and commercially viable image prompts for a stock image generation tool (like Leonardo AI or Midjourney) based on the core concept/keyword "${keyword}". Each prompt should be a single, cohesive paragraph that clearly defines:

                    1.  **Subject + Action + Setting:** What is the main subject, what are they doing, and where are they? (e.g., "A diverse group of young professionals collaborating in a modern coworking space.")
                    2.  **Specific style/details:** Artistic style (e.g., photorealistic, cinematic, isometric, minimalist), textures, specific objects, expressions, or visual elements. (e.g., "Photorealistic, with warm ambient lighting and soft bokeh.")
                    3.  **Lighting:** Describe the quality, direction, and mood of the lighting. (e.g., "Golden hour sunlight streaming through large windows.")
                    4.  **Colors:** Mention the dominant color palette or desired color mood. (e.g., "Predominantly earth tones with vibrant pops of teal.")
                    5.  **Composition:** How is the scene framed? (e.g., "Wide-angle shot, rule of thirds composition, plenty of copy space.")
                    6.  **Technical details:** Resolution, background type (e.g., "pure white background", "on transparent background"), lens effects, depth of field. (e.g., "Ultra-sharp 8K resolution, f/1.8 depth of field.")
                    7.  **Mood/Emotion:** The overall feeling or message the image should convey. (e.g., "Conveys a sense of teamwork, innovation, and positive energy.")

                    Combine these elements into a fluid, descriptive paragraph for each of the 10 prompts. Ensure no numbering or additional conversational text.`;
                    
                    const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
                    const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`;
                    
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(`API error: ${errorData.error?.message || response.statusText}`);
                    }

                    const result = await response.json();
                    if (result.candidates && result.candidates[0]?.content?.parts[0]?.text) {
                        const text = result.candidates[0].content.parts[0].text;
                        const promptLines = text.split('\n').filter(line => line.trim() !== ''); // Filter out empty lines
                        promptsOutput.innerHTML = promptLines.map((p, index) => `
                            <div class="prompt-chip-item bg-gray-50 p-3 rounded-md border text-sm flex justify-between items-center">
                                <span class="flex-grow mr-2">${p.trim()}</span>
                                <button class="copy-prompt-btn bg-teal-500 text-white text-xs font-semibold px-3 py-1 rounded-md hover:bg-teal-600 transition">Copy</button>
                            </div>
                        `).join('');
                        
                        addKeywordToHistory('usedPromptKeywords', keyword);
                        promptKeywordInput.classList.add('prompt-keyword-input-used');


                        document.querySelectorAll('.copy-prompt-btn').forEach(button => {
                            button.addEventListener('click', (p_event) => {
                                const promptText = p_event.currentTarget.previousElementSibling.textContent;
                                navigator.clipboard.writeText(promptText).then(() => {
                                    // Show copy message
                                    promptCopyMessage.style.display = 'block';
                                    promptCopyMessage.classList.remove('fadeOut');
                                    promptCopyMessage.classList.add('slideInUp');
                                    setTimeout(() => {
                                        promptCopyMessage.classList.remove('slideInUp');
                                        promptCopyMessage.classList.add('fadeOut');
                                    }, 4000);

                                    // Highlight the copied prompt item
                                    const parentItem = p_event.currentTarget.closest('.prompt-chip-item');
                                    if (parentItem) {
                                        parentItem.classList.add('copied');
                                        // Remove the copied class after the animation duration
                                        setTimeout(() => {
                                            parentItem.classList.remove('copied');
                                        }, 2000); // Should match the animation duration
                                    }

                                    window.open('https://leonardo.ai/ai-image-generation', '_blank');
                                }).catch(err => {
                                    console.error('Failed to copy prompt: ', err);
                                    promptCopyMessage.textContent = 'Failed to copy. Copy manually and paste into Leonardo AI.';
                                    promptCopyMessage.style.backgroundColor = '#dc2626';
                                    promptCopyMessage.style.display = 'block';
                                    promptCopyMessage.classList.remove('fadeOut');
                                    promptCopyMessage.classList.add('slideInUp');
                                });
                            });
                        });
                    } else {
                        throw new Error('No prompts received.');
                    }
                } catch (error) {
                    console.error('Error generating prompts:', error);
                    promptsError.textContent = `Failed to get prompts: ${error.message}.`;
                    promptsError.classList.remove('hidden');
                } finally {
                    promptsLoading.classList.add('hidden');
                    generatePromptsBtn.disabled = false;
                }
            });

            // Step 7: Smart Tagging & Export
            const imageUploadInput = document.getElementById('image-upload-input');
            const uploadStatus = document.getElementById('upload-status');
            const analyzeImagesBtn = document.getElementById('analyze-images-btn');
            const metadataLoading = document.getElementById('metadata-loading');
            const metadataError = document.getElementById('metadata-error');
            const imagePreviewsContainer = document.getElementById('image-previews-container');
            const metadataResultsContainer = document.getElementById('metadata-results-container');
            const metadataTableBody = document.getElementById('metadata-table-body');
            const exportCsvBtn = document.getElementById('export-csv-btn');

            const titleLengthSlider = document.getElementById('title-length-slider');
            const titleLengthValue = document.getElementById('title-length-value');
            const tagsLimitSlider = document.getElementById('tags-limit-slider');
            const tagsLimitValue = document.getElementById('tags-limit-value');
            const transparentBackgroundToggle = document.getElementById('transparent-background-toggle');

            let uploadedFiles = []; // To store File objects
            let generatedMetadata = []; // To store metadata for CSV export

            // Update slider values
            titleLengthSlider.addEventListener('input', () => {
                titleLengthValue.textContent = titleLengthSlider.value;
            });
            tagsLimitSlider.addEventListener('input', () => {
                tagsLimitValue.textContent = tagsLimitSlider.value;
            });

            imageUploadInput.addEventListener('change', (event) => {
                uploadedFiles = Array.from(event.target.files);
                if (uploadedFiles.length > 0) {
                    uploadStatus.textContent = `Ready to analyze ${uploadedFiles.length} image(s).`;
                    imagePreviewsContainer.innerHTML = ''; // Clear previous previews
                    imagePreviewsContainer.classList.remove('hidden');
                    analyzeImagesBtn.disabled = false;
                    metadataResultsContainer.classList.add('hidden'); // Hide previous results
                    metadataTableBody.innerHTML = '';
                    generatedMetadata = [];
                    
                    uploadedFiles.forEach(file => {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            const imgDiv = document.createElement('div');
                            imgDiv.className = 'relative w-24 h-24 rounded-md overflow-hidden bg-gray-200 flex items-center justify-center';
                            const img = document.createElement('img');
                            img.src = e.target.result;
                            img.className = 'w-full h-full object-cover';
                            imgDiv.appendChild(img);
                            imagePreviewsContainer.appendChild(imgDiv);
                        };
                        reader.readAsDataURL(file);
                    });

                } else {
                    uploadStatus.textContent = 'No images selected.';
                    analyzeImagesBtn.disabled = true;
                    imagePreviewsContainer.classList.add('hidden');
                }
            });

            analyzeImagesBtn.addEventListener('click', async () => {
                if (uploadedFiles.length === 0) {
                    metadataError.textContent = 'Please upload images first.';
                    metadataError.classList.remove('hidden');
                    return;
                }

                metadataResultsContainer.classList.add('hidden');
                metadataTableBody.innerHTML = '';
                generatedMetadata = [];
                metadataError.classList.add('hidden');
                metadataLoading.classList.remove('hidden');
                analyzeImagesBtn.disabled = true;
                exportCsvBtn.disabled = true;

                const titleLength = parseInt(titleLengthSlider.value);
                const tagsLimit = parseInt(tagsLimitSlider.value);
                const addTransparentBgToTitle = transparentBackgroundToggle.checked;

                let processedCount = 0;
                for (const file of uploadedFiles) {
                    uploadStatus.textContent = `Analyzing ${processedCount + 1} of ${uploadedFiles.length}: ${file.name}`;
                    try {
                        const base64Image = await new Promise((resolve, reject) => {
                            const reader = new FileReader();
                            reader.onload = () => resolve(reader.result.split(',')[1]); // Get base64 part
                            reader.onerror = error => reject(error);
                            reader.readAsDataURL(file);
                        });

                        const mimeType = file.type;

                        // Prompt for Title
                        let titlePrompt = `Generate a concise, descriptive, and SEO-friendly title for a stock image based on its content. Keep it between ${titleLength} and ${titleLength + 20} characters.`;
                        if (addTransparentBgToTitle) {
                            titlePrompt += ` If the image appears to have a transparent background, also add "on transparent background" to the title.`;
                        }
                        titlePrompt += ` Provide only the title, no extra text.`;

                        const titlePayload = {
                            contents: [{
                                parts: [
                                    { text: titlePrompt },
                                    { inlineData: { mimeType: mimeType, data: base64Image } }
                                ]
                            }]
                        };

                        // Prompt for Keywords
                        const keywordPrompt = `Generate ${tagsLimit} highly relevant, commercially viable, and diverse keywords for a stock image based on its content. Provide only the keywords, separated by commas, no extra text or numbering.`;
                        const keywordPayload = {
                            contents: [{
                                parts: [
                                    { text: keywordPrompt },
                                    { inlineData: { mimeType: mimeType, data: base64Image } }
                                ]
                            }]
                        };

                        // Fetch Title (using gemini-pro-vision model)
                        const titleResponse = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro-vision:generateContent?key=${GEMINI_API_KEY}`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(titlePayload)
                        });
                        const titleResult = await titleResponse.json();
                        // Basic error check for API response structure
                        let generatedTitle = 'Title Generation Error';
                        if (titleResult.candidates && titleResult.candidates[0]?.content?.parts[0]?.text) {
                            generatedTitle = titleResult.candidates[0].content.parts[0].text.replace(/^["']|["']$/g, '').trim(); // Remove extra quotes
                        } else if (titleResult.error) {
                            generatedTitle = `Title API Error: ${titleResult.error.message}`;
                        }


                        // Fetch Keywords (using gemini-pro-vision model as it also handles image input well)
                        const keywordResponse = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-pro-vision:generateContent?key=${GEMINI_API_KEY}`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(keywordPayload)
                        });
                        const keywordResult = await keywordResponse.json();
                        // Basic error check for API response structure
                        let generatedKeywords = 'Keywords Generation Error';
                        if (keywordResult.candidates && keywordResult.candidates[0]?.content?.parts[0]?.text) {
                            generatedKeywords = keywordResult.candidates[0].content.parts[0].text.replace(/["']|\.+$/g, '').trim(); // Remove extra quotes/trailing dots
                            generatedKeywords = generatedKeywords.split(',').map(k => k.trim()).filter(Boolean).slice(0, tagsLimit).join(', ');
                        } else if (keywordResult.error) {
                            generatedKeywords = `Keywords API Error: ${keywordResult.error.message}`;
                        }


                        generatedMetadata.push({
                            fileName: file.name,
                            title: generatedTitle,
                            keywords: generatedKeywords
                        });

                        const row = metadataTableBody.insertRow();
                        row.innerHTML = `
                            <td class="px-2 py-2 whitespace-nowrap"><img src="${URL.createObjectURL(file)}" class="h-12 w-12 object-cover rounded-md inline-block mr-2" alt="${file.name}"> ${file.name}</td>
                            <td class="px-2 py-2">${generatedTitle}</td>
                            <td class="px-2 py-2 text-wrap">${generatedKeywords}</td>
                        `;
                    } catch (error) {
                        console.error(`Error processing image ${file.name}:`, error);
                        metadataError.textContent = `Error processing ${file.name}: ${error.message}. Check your API key or browser console.`;
                        metadataError.classList.remove('hidden');
                        generatedMetadata.push({
                            fileName: file.name,
                            title: 'Error generating',
                            keywords: 'Error generating'
                        });
                         const row = metadataTableBody.insertRow();
                        row.innerHTML = `
                            <td class="px-2 py-2 whitespace-nowrap"><img src="${URL.createObjectURL(file)}" class="h-12 w-12 object-cover rounded-md inline-block mr-2" alt="${file.name}"> ${file.name}</td>
                            <td class="px-2 py-2 text-red-500">Error generating</td>
                            <td class="px-2 py-2 text-red-500">Error generating</td>
                        `;
                    }
                    processedCount++;
                    uploadStatus.textContent = `Analyzed ${processedCount} of ${uploadedFiles.length}.`;
                }

                metadataLoading.classList.add('hidden');
                analyzeImagesBtn.disabled = false;
                metadataResultsContainer.classList.remove('hidden');
                exportCsvBtn.disabled = generatedMetadata.length === 0;
                uploadStatus.textContent = `Analysis complete for ${uploadedFiles.length} images.`;
            });

            exportCsvBtn.addEventListener('click', () => {
                let csvContent = "File Name,Title,Keywords\n";
                generatedMetadata.forEach(row => {
                    // Escape commas and double quotes for CSV format
                    const escapedTitle = `"${row.title.replace(/"/g, '""')}"`;
                    const escapedKeywords = `"${row.keywords.replace(/"/g, '""')}"`;
                    csvContent += `${row.fileName},${escapedTitle},${escapedKeywords}\n`;
                });

                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                if (link.download !== undefined) {
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', 'adobe_stock_metadata.csv');
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                } else {
                    alert('Your browser does not support downloading CSV files directly. Please copy the data manually.');
                }
            });


            // Charts (Step 8)
            new Chart(document.getElementById('growthChart').getContext('2d'), {
                type: 'line',
                data: {
                    labels: ['Month 1', 'Month 3', 'Month 6', 'Month 9', 'Month 12'],
                    datasets: [{
                        label: 'Potential Earnings (Illustrative)',
                        data: [25, 75, 250, 500, 1000],
                        backgroundColor: 'rgba(5, 150, 105, 0.2)',
                        borderColor: '#059669',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { beginAtZero: true, title: { display: true, text: 'Earnings ($)' } },
                        x: { title: { display: true, text: 'Time' } }
                    }
                }
            });

            new Chart(document.getElementById('mixChart').getContext('2d'), {
                type: 'doughnut',
                data: {
                    labels: ['Organic Photos', 'AI Images', 'Videos'],
                    datasets: [{
                        data: [50, 40, 10],
                        backgroundColor: ['#059669', '#047857', '#065f46'],
                        hoverOffset: 4
                    }]
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    plugins: { legend: { position: 'bottom' } }
                }
            });
        });
    </script>
</body>
</html>
